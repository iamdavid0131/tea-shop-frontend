# ======================================================
# â˜ï¸ ç¥¥èˆˆèŒ¶è¡Œ Cloudflare Worker + Pages è¨­å®šæª”
# ======================================================

name = "hsianghsing-api"
main = "worker.js"
compatibility_date = "2025-10-25"

# ======================================================
# ğŸŒ Pages æ¨¡å¼ï¼šéœæ…‹å‰ç«¯è¨­å®š
# ------------------------------------------------------
# Pages æ¨¡å¼ä¸‹ï¼ŒASSETS æ‰æœƒè¢«è‡ªå‹•æ³¨å…¥
pages_build_output_dir = "./"   # â† è®“ ASSETS.fetch(req) èƒ½é‹ä½œ

# ======================================================
# ğŸ­ ç’°å¢ƒè®Šæ•¸è¨­å®š
# ------------------------------------------------------
[vars]
NODE_API = "http://127.0.0.1:3000"
ALLOW_ORIGIN = "http://localhost:8788"

# ======================================================
# âš™ï¸ æ­£å¼è·¯ç”±
# ------------------------------------------------------
routes = [
  { pattern = "hsianghsing.org/api/*", zone_id = "f23528900e3fe147202e4ee63e884590" },
  { pattern = "www.hsianghsing.org/api/*", zone_id = "f23528900e3fe147202e4ee63e884590" }
]

# ======================================================
# ğŸ§ª é–‹ç™¼æ¨¡å¼è¨­å®šï¼ˆwrangler pages dev ç”¨ï¼‰
# ------------------------------------------------------
[env.development]
# æŒ‡å®šé–‹ç™¼ç’°å¢ƒè®Šæ•¸ï¼ˆæœƒè¦†è“‹ä¸Šé¢çš„ varsï¼‰
[env.development.vars]
NODE_API = "http://localhost:3000"
ALLOW_ORIGIN = "http://localhost:8788"

# ======================================================
# ğŸ§¾ éƒ¨ç½²æ³¨æ„äº‹é …
# ------------------------------------------------------
# âœ… æœ¬åœ°é–‹ç™¼ï¼š
#    1. å•Ÿå‹• Node.js å¾Œç«¯ â†’ `node server.js`
#    2. å•Ÿå‹• Worker ä»£ç† â†’ `wrangler pages dev .`
#
# âœ… æ­£å¼éƒ¨ç½²ï¼š
#    1. å°‡ Node.js API éƒ¨ç½²è‡³é›²ç«¯ï¼ˆRender / Railway / Fly.ioï¼‰
#    2. å°‡ä¸‹æ–¹ NODE_API æ”¹æˆæ­£å¼å¾Œç«¯ç¶²å€
#    3. åŸ·è¡Œ `wrangler deploy`
#
# âœ… é©—è­‰ï¼š
#    æ‰“é–‹ç€è¦½å™¨åŸ·è¡Œï¼š
#       fetch('/api/health').then(r => r.json()).then(console.log)
#    é æœŸçµæœï¼š
#       { "ok": true, "ts": "2025-10-27T..." }

# ======================================================
# ğŸª¶ Cloudflare Pages éœæ…‹é é¢è¨­å®š
# ------------------------------------------------------
[site]
bucket = "./"           # â† ä½ çš„ index.html èˆ‡ app.js æ‰€åœ¨è³‡æ–™å¤¾
