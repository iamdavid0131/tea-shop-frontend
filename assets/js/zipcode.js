// âœ… zipcode.js â€” Taiwan Cityâ€§Districtâ€§Zip Autoload Module
import { $ } from "./dom.js";
// ğŸ“¦ zip.js â€” å…¨å°éƒµéå€è™Ÿå°ç…§è¡¨
export const ZIP_MAP = {
  "åŸºéš†å¸‚": {
    "ä»æ„›å€": "200", "ä¿¡ç¾©å€": "201", "ä¸­æ­£å€": "202", "ä¸­å±±å€": "203", "å®‰æ¨‚å€": "204", "æš–æš–å€": "205", "ä¸ƒå µå€": "206"
  },
  "å°åŒ—å¸‚": {
    "ä¸­æ­£å€": "100", "å¤§åŒå€": "103", "ä¸­å±±å€": "104", "æ¾å±±å€": "105", "å¤§å®‰å€": "106", "è¬è¯å€": "108",
    "ä¿¡ç¾©å€": "110", "å£«æ—å€": "111", "åŒ—æŠ•å€": "112", "å…§æ¹–å€": "114", "å—æ¸¯å€": "115", "æ–‡å±±å€": "116"
  },
  "æ–°åŒ—å¸‚": {
    "è¬é‡Œå€": "207", "é‡‘å±±å€": "208", "æ¿æ©‹å€": "220", "æ±æ­¢å€": "221", "æ·±å‘å€": "222", "çŸ³ç¢‡å€": "223",
    "ç‘èŠ³å€": "224", "å¹³æºªå€": "226", "é›™æºªå€": "227", "è²¢å¯®å€": "228", "æ–°åº—å€": "231", "åªæ—å€": "232",
    "çƒä¾†å€": "233", "æ°¸å’Œå€": "234", "ä¸­å’Œå€": "235", "åœŸåŸå€": "236", "ä¸‰å³½å€": "237", "æ¨¹æ—å€": "238",
    "é¶¯æ­Œå€": "239", "ä¸‰é‡å€": "241", "æ–°èŠå€": "242", "æ³°å±±å€": "243", "æ—å£å€": "244", "è˜†æ´²å€": "247",
    "äº”è‚¡å€": "248", "å…«é‡Œå€": "249", "æ·¡æ°´å€": "251", "ä¸‰èŠå€": "252", "çŸ³é–€å€": "253"
  },
  "æ¡ƒåœ’å¸‚": {
    "ä¸­å£¢å€": "320", "å¹³é®å€": "324", "é¾æ½­å€": "325", "æ¥Šæ¢…å€": "326", "æ–°å±‹å€": "327", "è§€éŸ³å€": "328",
    "æ¡ƒåœ’å€": "330", "é¾œå±±å€": "333", "å…«å¾·å€": "334", "å¤§æºªå€": "335", "å¾©èˆˆå€": "336", "å¤§åœ’å€": "337", "è˜†ç«¹å€": "338"
  },
  "æ–°ç«¹å¸‚": {
    "æ±å€": "300", "åŒ—å€": "300", "é¦™å±±å€": "300"
  },
  "æ–°ç«¹ç¸£": {
    "ç«¹åŒ—å¸‚": "302", "æ¹–å£é„‰": "303", "æ–°è±é„‰": "304", "æ–°åŸ”é®": "305", "é—œè¥¿é®": "306", "èŠæ—é„‰": "307",
    "å¯¶å±±é„‰": "308", "ç«¹æ±é®": "310", "äº”å³°é„‰": "311", "æ©«å±±é„‰": "312", "å°–çŸ³é„‰": "313", "åŒ—åŸ”é„‰": "314", "å³¨çœ‰é„‰": "315"
  },
  "è‹—æ —ç¸£": {
    "ç«¹å—é®": "350", "é ­ä»½å¸‚": "351", "ä¸‰ç£é„‰": "352", "å—åº„é„‰": "353", "ç…æ½­é„‰": "354", "å¾Œé¾é®": "356",
    "é€šéœ„é®": "357", "è‹‘è£¡é®": "358", "è‹—æ —å¸‚": "360", "é€ æ©‹é„‰": "361", "é ­å±‹é„‰": "362", "å…¬é¤¨é„‰": "363",
    "å¤§æ¹–é„‰": "364", "æ³°å®‰é„‰": "365", "éŠ…é‘¼é„‰": "366", "ä¸‰ç¾©é„‰": "367", "è¥¿æ¹–é„‰": "368", "å“è˜­é®": "369"
  },
  "å°ä¸­å¸‚": {
    "ä¸­å€": "400", "æ±å€": "401", "å—å€": "402", "è¥¿å€": "403", "åŒ—å€": "404", "åŒ—å±¯å€": "406", "è¥¿å±¯å€": "407",
    "å—å±¯å€": "408", "å¤ªå¹³å€": "411", "å¤§é‡Œå€": "412", "éœ§å³°å€": "413", "çƒæ—¥å€": "414", "è±åŸå€": "420",
    "åé‡Œå€": "421", "çŸ³å²¡å€": "422", "æ±å‹¢å€": "423", "å’Œå¹³å€": "424", "æ–°ç¤¾å€": "426", "æ½­å­å€": "427",
    "å¤§é›…å€": "428", "ç¥å²¡å€": "429", "å¤§è‚šå€": "432", "æ²™é¹¿å€": "433", "é¾äº•å€": "434", "æ¢§æ£²å€": "435",
    "æ¸…æ°´å€": "436", "å¤§ç”²å€": "437", "å¤–åŸ”å€": "438", "å¤§å®‰å€": "439"
  },
  "å½°åŒ–ç¸£": {
    "å½°åŒ–å¸‚": "500", "èŠ¬åœ’é„‰": "502", "èŠ±å£‡é„‰": "503", "ç§€æ°´é„‰": "504", "é¹¿æ¸¯é®": "505", "ç¦èˆˆé„‰": "506",
    "ç·šè¥¿é„‰": "507", "å’Œç¾é®": "508", "ä¼¸æ¸¯é„‰": "509", "å“¡æ—å¸‚": "510", "ç¤¾é ­é„‰": "511", "æ°¸é–é„‰": "512",
    "åŸ”å¿ƒé„‰": "513", "æºªæ¹–é®": "514", "å¤§æ‘é„‰": "515", "åŸ”é¹½é„‰": "516", "ç”°ä¸­é®": "520", "åŒ—æ–—é®": "521",
    "ç”°å°¾é„‰": "522", "åŸ¤é ­é„‰": "523", "æºªå·é„‰": "524", "ç«¹å¡˜é„‰": "525", "äºŒæ—é®": "526", "å¤§åŸé„‰": "527",
    "èŠ³è‹‘é„‰": "528", "äºŒæ°´é„‰": "530"
  },
  "å—æŠ•ç¸£": {
    "å—æŠ•å¸‚": "540", "ä¸­å¯®é„‰": "541", "è‰å±¯é®": "542", "åœ‹å§“é„‰": "544", "åŸ”é‡Œé®": "545", "ä»æ„›é„‰": "546",
    "åé–“é„‰": "551", "é›†é›†é®": "552", "æ°´é‡Œé„‰": "553", "é­šæ± é„‰": "555", "ä¿¡ç¾©é„‰": "556", "ç«¹å±±é®": "557", "é¹¿è°·é„‰": "558"
  },
  "é›²æ—ç¸£": {
    "æ–—å—é®": "630", "å¤§åŸ¤é„‰": "631", "è™å°¾é®": "632", "åœŸåº«é®": "633", "è¤’å¿ é„‰": "634", "æ±å‹¢é„‰": "635",
    "è‡ºè¥¿é„‰": "636", "å´™èƒŒé„‰": "637", "éº¥å¯®é„‰": "638", "æ–—å…­å¸‚": "640", "æ—å…§é„‰": "643", "å¤å‘é„‰": "646",
    "è¿æ¡é„‰": "647", "è¥¿èºé®": "648", "äºŒå´™é„‰": "649", "åŒ—æ¸¯é®": "651", "æ°´æ—é„‰": "652", "å£æ¹–é„‰": "653",
    "å››æ¹–é„‰": "654", "å…ƒé•·é„‰": "655"
  },
  "å˜‰ç¾©å¸‚": { "æ±å€": "600", "è¥¿å€": "600" },
  "å˜‰ç¾©ç¸£": {
    "ç•ªè·¯é„‰": "602", "æ¢…å±±é„‰": "603", "ç«¹å´é„‰": "604", "é˜¿é‡Œå±±": "605", "ä¸­åŸ”é„‰": "606", "å¤§åŸ”é„‰": "607",
    "æ°´ä¸Šé„‰": "608", "é¹¿è‰é„‰": "611", "å¤ªä¿å¸‚": "612", "æœ´å­å¸‚": "613", "æ±çŸ³é„‰": "614", "å…­è…³é„‰": "615",
    "æ–°æ¸¯é„‰": "616", "æ°‘é›„é„‰": "621", "å¤§æ—é®": "622", "æºªå£é„‰": "623", "ç¾©ç«¹é„‰": "624", "å¸ƒè¢‹é®": "625"
  },
  "å°å—å¸‚": {
    "ä¸­è¥¿å€": "700", "æ±å€": "701", "å—å€": "702", "åŒ—å€": "704", "å®‰å¹³å€": "708", "å®‰å—å€": "709", "æ°¸åº·å€": "710",
    "æ­¸ä»å€": "711", "æ–°åŒ–å€": "712", "å·¦é®å€": "713", "ç‰äº•å€": "714", "æ¥ è¥¿å€": "715", "å—åŒ–å€": "716",
    "ä»å¾·å€": "717", "é—œå»Ÿå€": "718", "é¾å´å€": "719", "å®˜ç”°å€": "720", "éº»è±†å€": "721", "ä½³é‡Œå€": "722",
    "è¥¿æ¸¯å€": "723", "ä¸ƒè‚¡å€": "724", "å°‡è»å€": "725", "å­¸ç”²å€": "726", "åŒ—é–€å€": "727", "æ–°ç‡Ÿå€": "730",
    "å¾Œå£å€": "731", "ç™½æ²³å€": "732", "æ±å±±å€": "733", "å…­ç”²å€": "734", "ä¸‹ç‡Ÿå€": "735", "æŸ³ç‡Ÿå€": "736",
    "é¹½æ°´å€": "737", "å–„åŒ–å€": "741", "å¤§å…§å€": "742", "å±±ä¸Šå€": "743", "æ–°å¸‚å€": "744", "å®‰å®šå€": "745"
  },
  "é«˜é›„å¸‚": {
    "æ–°èˆˆå€": "800", "å‰é‡‘å€": "801", "è‹“é›…å€": "802", "é¹½åŸ•å€": "803", "é¼“å±±å€": "804", "æ——æ´¥å€": "805",
    "å‰é®å€": "806", "ä¸‰æ°‘å€": "807", "æ¥ æ¢“å€": "811", "å°æ¸¯å€": "812", "å·¦ç‡Ÿå€": "813", "ä»æ­¦å€": "814",
    "å¤§ç¤¾å€": "815", "å²¡å±±å€": "820", "è·¯ç«¹å€": "821", "é˜¿è“®å€": "822", "ç”°å¯®é„‰": "823", "ç‡•å·¢å€": "824",
    "æ©‹é ­å€": "825", "æ¢“å®˜å€": "826", "å½Œé™€å€": "827", "æ°¸å®‰å€": "828", "æ¹–å…§é„‰": "829", "é³³å±±å€": "830",
    "å¤§å¯®å€": "831", "æ—åœ’å€": "832", "é³¥æ¾å€": "833", "å¤§æ¨¹å€": "840", "æ——å±±å€": "842", "ç¾æ¿ƒå€": "843",
    "å…­é¾œå€": "844", "å…§é–€å€": "845", "æ‰æ—å€": "846", "ç”²ä»™å€": "847", "æ¡ƒæºå€": "848", "é‚£ç‘ªå¤å€": "849",
    "èŒ‚æ—å€": "851", "èŒ„è£å€": "852"
  },
  "å±æ±ç¸£": {
    "å±æ±å¸‚": "900", "ä¸‰åœ°é–€": "901", "éœ§è‡ºé„‰": "902", "ç‘ªå®¶é„‰": "903", "ä¹å¦‚é„‰": "904", "é‡Œæ¸¯é„‰": "905",
    "é«˜æ¨¹é„‰": "906", "é¹½åŸ”é„‰": "907", "é•·æ²»é„‰": "908", "éºŸæ´›é„‰": "909", "ç«¹ç”°é„‰": "911", "å…§åŸ”é„‰": "912",
    "è¬ä¸¹é„‰": "913", "æ½®å·é®": "920", "æ³°æ­¦é„‰": "921", "ä¾†ç¾©é„‰": "922", "è¬å·’é„‰": "923", "å´é ‚é„‰": "924",
    "æ–°åŸ¤é„‰": "925", "å—å·é„‰": "926", "æ—é‚Šé„‰": "927", "æ±æ¸¯é®": "928", "ç‰çƒé„‰": "929", "ä½³å†¬é„‰": "931",
    "æ–°åœ’é„‰": "932", "æ‹å¯®é„‰": "940", "æ‹å±±é„‰": "941", "æ˜¥æ—¥é„‰": "942", "ç…å­é„‰": "943", "è»ŠåŸé„‰": "944",
    "ç‰¡ä¸¹é„‰": "945", "æ†æ˜¥é®": "946", "æ»¿å·é„‰": "947"
  },
  "å°æ±ç¸£": {
    "è‡ºæ±å¸‚": "950", "ç¶ å³¶é„‰": "951", "è˜­å¶¼é„‰": "952", "å»¶å¹³é„‰": "953", "å‘å—é„‰": "954", "é¹¿é‡é„‰": "955",
    "é—œå±±é®": "956", "æµ·ç«¯é„‰": "957", "æ± ä¸Šé„‰": "958", "æ±æ²³é„‰": "959", "æˆåŠŸé®": "961", "é•·æ¿±é„‰": "962",
    "å¤ªéº»é‡Œé„‰": "963", "é‡‘å³°é„‰": "964", "å¤§æ­¦é„‰": "965", "é”ä»é„‰": "966"
  },
  "èŠ±è“®ç¸£": {
    "èŠ±è“®å¸‚": "970", "æ–°åŸé„‰": "971", "ç§€æ—é„‰": "972", "å‰å®‰é„‰": "973", "å£½è±é„‰": "974", "é³³æ—é®": "975",
    "å…‰å¾©é„‰": "976", "è±æ¿±é„‰": "977", "ç‘ç©—é„‰": "978", "è¬æ¦®é„‰": "979", "ç‰é‡Œé®": "981", "å“æºªé„‰": "982", "å¯Œé‡Œé„‰": "983"
  },
  "æ¾æ¹–ç¸£": {
    "é¦¬å…¬å¸‚": "880", "è¥¿å¶¼é„‰": "881", "æœ›å®‰é„‰": "882", "ä¸ƒç¾é„‰": "883", "ç™½æ²™é„‰": "884", "æ¹–è¥¿é„‰": "885"
  },
  "é‡‘é–€ç¸£": {
    "é‡‘æ²™é®": "890", "é‡‘æ¹–é®": "891", "é‡‘å¯§é„‰": "892", "é‡‘åŸé®": "893", "çƒˆå¶¼é„‰": "894", "çƒåµé„‰": "896"
  },
  "é€£æ±Ÿç¸£": {
    "å—ç«¿é„‰": "209", "åŒ—ç«¿é„‰": "210", "è’å…‰é„‰": "211", "æ±å¼•é„‰": "212"
  },
  "å—æµ·è«¸å³¶": {
    "æ±æ²™": "817", "å—æ²™": "819"
  }
};


// âœ… è®“ zipcode UI ä¸€éµå•Ÿç”¨
export function initZipAuto() {
  const addressInput = $("address");
  const zipDisplay = $("zipDisplay");
  const zipCode = $("zipCode");

  if (!addressInput || !zipDisplay) return;

  addressInput.addEventListener("input", () => {
    const zip = inferZip(addressInput.value);
    zipDisplay.textContent = zip || "â€”";
    if (zipCode) zipCode.value = zip || "";
  });
}

// âœ… ã€Œä¾åœ°å€å­—ä¸²ã€æ¨æ–·éƒµéå€è™Ÿ
export function inferZip(address) {
  for (const city in ZIP_MAP) {
    if (!address.includes(city)) continue;
    for (const dist in ZIP_MAP[city]) {
      if (address.includes(dist)) {
        return ZIP_MAP[city][dist];
      }
    }
  }
  return "";
}
