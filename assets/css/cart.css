/* ============================================================
   üõí Ë≥ºÁâ©Ëªä„ÄÅÁµêÂ∏≥„ÄÅÊàêÂäüÁï´Èù¢Ê®£Âºè (Cart & Success)
   ============================================================ */

/* ============================================================
   1. StickyBar (Â∫ïÈÉ®Êá∏ÊµÆÂ≥∂Â∂º - ÊóóËâ¶Áâà)
   ============================================================ */

.stickybar {
  overflow: visible !important;
  position: fixed; 
  bottom: 20px; /* Êá∏ÊµÆË∑ùÈõ¢ */
  left: 16px; 
  right: 16px; 
  z-index: 999;
  
  padding: 16px 20px;
  border-radius: 24px; /* Â§ßÂúìËßí */
  
  /* È´òÁ¥öÁéªÁíÉË≥™ÊÑü */
  background: rgba(255, 255, 255, 0.85);
  backdrop-filter: blur(20px) saturate(180%);
  -webkit-backdrop-filter: blur(20px) saturate(180%);
  
  border: 1px solid rgba(255, 255, 255, 0.6);
  box-shadow: 
    0 10px 30px rgba(0, 0, 0, 0.1),
    0 4px 8px rgba(0, 0, 0, 0.05),
    inset 0 1px 0 rgba(255, 255, 255, 0.5);
    
  transition: all 0.45s cubic-bezier(0.25, 1, 0.5, 1);
  transform-origin: bottom center;
  
  /* Á¢∫‰øùÂØ¨Â∫¶‰∏çÊúÉÁàÜÁâà */
  max-width: 600px;
  margin: 0 auto;
}

.stickybar.hide { transform: translateY(150%) scale(0.9); opacity: 0; }
.stickybar.show { transform: translateY(0) scale(1); opacity: 1; }

/* === ÂÖßÈÉ®ÊéíÁâà === */
.sticky-inner {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 16px;
  position: relative;
  z-index: 2;
}

/* === Â∑¶ÂÅ¥ÔºöÈáëÈ°ç === */
.amount-box {
  display: flex;
  flex-direction: column;
  gap: 2px;
}

.grand-total {
  display: flex;
  align-items: baseline;
  gap: 6px;
}

.grand-total .label {
  font-size: 13px;
  color: #7a8c82;
  font-weight: 500;
}

.grand-total b {
  font-size: 22px;
  font-weight: 800;
  color: #2f4b3c;
  letter-spacing: 0.5px;
  font-family: "Noto Serif TC", serif; /* Êï∏Â≠óÁî®ÂÆãÈ´îÊõ¥ÊúâË≥™ÊÑü */
}

.sub-detail {
  font-size: 12px;
  color: #889990;
  display: flex;
  gap: 8px;
}

/* ÈÅãË≤ªÂ∞èÊ®ôÁ±§ */
.ship-tag {
  background: rgba(90, 123, 104, 0.1);
  padding: 1px 6px;
  border-radius: 4px;
  color: #5a7b68;
  font-weight: 600;
}

/* === Âè≥ÂÅ¥ÔºöÊìç‰ΩúÂçÄ === */
.action-box {
  display: flex;
  align-items: center;
  gap: 10px;
}

/* Êü•ÁúãÊòéÁ¥∞ (ÂúìÂΩ¢ÊåâÈàï) */
.icon-btn {
  width: 42px;
  height: 42px;
  border-radius: 50%;
  border: 1px solid rgba(180, 200, 190, 0.5);
  background: rgba(255, 255, 255, 0.6);
  color: #5a7b68;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: all 0.2s;
  font-size: 12px;
}
.icon-btn:hover {
  background: #fff;
  transform: translateY(-2px);
  box-shadow: 0 4px 12px rgba(90, 123, 104, 0.15);
}

/* ÂéªË≤∑ÂñÆÊåâÈàï (Sticky Â∞àÁî®) */
.submit-btn-sticky {
  padding: 10px 24px;
  height: 42px;
  border-radius: 21px; /* ËÜ†ÂõäÁãÄ */
  background: linear-gradient(135deg, #2f4b3c, #4a6b58);
  color: #fff;
  font-weight: 600;
  font-size: 15px;
  border: none;
  box-shadow: 0 4px 14px rgba(47, 75, 60, 0.3);
  cursor: pointer;
  transition: all 0.2s;
  white-space: nowrap;
}
.submit-btn-sticky:hover {
  transform: translateY(-2px);
  box-shadow: 0 6px 18px rgba(47, 75, 60, 0.4);
  background: linear-gradient(135deg, #3a5c4a, #5a7b68);
}

/* === ÂÖçÈÅãÈÄ≤Â∫¶Ê¢ù (Êï¥ÂêàÂú®È†ÇÈÉ®) === */
.progress-bar-wrap {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: 4px; /* Ê•µÁ¥∞ */
  background: transparent;
  border-radius: 24px 24px 0 0; /* Ë∑üÈö®Âç°ÁâáÂúìËßí */
  overflow: hidden;
}

#freeProgressBar {
  height: 100%;
  width: 0%;
  /* Êº∏Â±§Á∂†Ëâ≤ */
  background: linear-gradient(90deg, #8fb79c, #5a7b68);
  border-radius: 0 4px 4px 0; /* Âè≥ÈÇäÂúìÈ†≠ */
  transition: width 0.5s cubic-bezier(0.25, 1, 0.5, 1);
  
  /* ÂæÆÂæÆÁôºÂÖâ */
  box-shadow: 0 0 6px rgba(90, 123, 104, 0.4);
}

/* ÂÖçÈÅãÊèêÁ§∫ (ÊµÆÂú®‰∏äÊñπ) */
.free-hint {
  position: absolute;
  /* üî• ‰ΩçÁΩÆ‰øÆÊ≠£ÔºöÊµÆÂú®Âç°ÁâáÊ≠£‰∏äÊñπÈÇäÁ∑£Ôºå‰∏çË¶ÅÈ£õÂ§™È´ò */
  top: -36px; 
  left: 50%;
  transform: translateX(-50%) translateY(10px) scale(0.9); /* ÂàùÂßãÁãÄÊÖãÔºöÂæÆÁ∏Æ+‰∏ãÊ≤â */
  
  /* Â§ñËßÄÁæéÂåñ */
  background: rgba(47, 75, 60, 0.9); /* Ê∑±Â¢®Á∂†Â∫ï */
  color: #fff;
  font-size: 13px;
  font-weight: 500;
  padding: 6px 14px;
  border-radius: 20px;
  
  white-space: nowrap;
  pointer-events: none;
  opacity: 0;
  
  /* È´òÁ¥öÈô∞ÂΩ± */
  box-shadow: 0 4px 12px rgba(0,0,0,0.15);
  backdrop-filter: blur(4px);
  
  /* ÂΩàË∑≥ÂãïÁï´Ë®≠ÂÆö */
  transition: 
    opacity 0.3s ease,
    transform 0.4s cubic-bezier(0.34, 1.56, 0.64, 1); /* QÂΩàÊõ≤Á∑ö */
  
  z-index: -1; /* ËÆìÂÆÉÂú®Âç°ÁâáÂæåÈù¢Â±§Á¥öÔºåË£ΩÈÄ†„ÄåÊµÆÂá∫„ÄçÊÑü */
}

.free-hint.show {
  opacity: 1;
  transform: translateX(-50%) translateY(0) scale(1);
  z-index: 1000; /* È°ØÁ§∫ÊôÇÊµÆÂà∞ÊúÄ‰∏äÂ±§ */
}

/* Âä†‰∏ä‰∏ÄÂÄãÂ∞è‰∏âËßíÂΩ¢ÊåáÈáù */
.free-hint::after {
  content: "";
  position: absolute;
  bottom: -5px;
  left: 50%;
  transform: translateX(-50%);
  border-width: 5px 5px 0;
  border-style: solid;
  border-color: rgba(47, 75, 60, 0.9) transparent transparent transparent;
}

/* 4. Á¢∫‰øùÂç°ÁâáÂÖßÂÆπÂ£ìÂú®ÈÄ≤Â∫¶Ê¢ù‰∏äÈù¢ */
.sticky-inner {
  position: relative;
  z-index: 2; /* Á¢∫‰øùÊñáÂ≠óÊåâÈàïÂú®ÈÄ≤Â∫¶Ê¢ù‰∏äÈù¢ */
  padding-top: 6px; /* Á®çÂæÆÁïôÈªûÁ©∫ÈñìÁµ¶ÈÄ≤Â∫¶Ê¢ùÂëºÂê∏ */
}

/* ÊâãÊ©üÁâàÈÅ©ÈÖç */
@media (max-width: 400px) {
  .stickybar { bottom: 16px; left: 12px; right: 12px; padding: 14px; }
  .grand-total b { font-size: 20px; }
  .submit-btn-sticky { padding: 8px 18px; font-size: 14px; }
}
/* === 2. Shopping Sheet (Ë≥ºÁâ©ÊòéÁ¥∞ Modal) === */
.sheet-backdrop {
  position: fixed; inset: 0; display: none; align-items: flex-end; justify-content: center;
  background: rgba(0, 0, 0, 0.45); backdrop-filter: blur(8px); z-index: 2000!important;
  opacity: 0; transition: opacity 0.4s ease;
}
.sheet-backdrop[aria-hidden="false"] { display: flex; opacity: 1; }

.sheet {
  position: fixed; left: 0; right: 0; bottom: 0; max-height: 80vh;
  background: linear-gradient(180deg, rgba(255, 255, 255, 0.92), rgba(255, 255, 255, 0.82));
  border-radius: 20px 20px 0 0; box-shadow: 0 -8px 24px rgba(0, 0, 0, 0.12);
  border: 1px solid rgba(150, 170, 160, 0.25);
  transform: translateY(110%); transition: transform 0.45s cubic-bezier(0.25, 1, 0.5, 1);
  z-index: 2001!important; padding: 18px 18px calc(28px + env(safe-area-inset-bottom));
  overflow-y: auto; -webkit-overflow-scrolling: touch;
}
.sheet[data-open="true"] { transform: translateY(0); }

/* üçµ Ëå∂ÈúßÂãïÁï´ÔºöÈñãÂïüÊôÇÊüîÂÖâ‰∏äÂçá */
.sheet::before {
  content: ""; position: absolute; inset: 0; border-radius: 20px 20px 0 0;
  background: radial-gradient(circle at 50% 90%, rgba(190, 220, 200, 0.25) 0%, rgba(255, 255, 255, 0.95) 60%);
  opacity: 0; transform: translateY(20px) scale(0.98); pointer-events: none; z-index: 0; mix-blend-mode: lighten;
}
.sheet[data-open="true"]::before { animation: teaMistRise 1.2s ease forwards; }
.sheet[data-open="false"]::before { animation: teaMistFade 0.8s ease forwards; }

@keyframes teaMistRise { 0% { opacity: 0; transform: translateY(20px); filter: blur(6px); } 100% { opacity: 1; transform: translateY(0); filter: blur(0); } }
@keyframes teaMistFade { 0% { opacity: 1; } 100% { opacity: 0; transform: translateY(20px); filter: blur(8px); } }

/* ÂÖßÂÆπÂª∂ÈÅ≤ÊµÆÂá∫ */
.sheet[data-open="true"] > * { position: relative; z-index: 1; animation: contentLift 0.6s ease 0.25s both; }
@keyframes contentLift { from { opacity: 0; transform: translateY(8px); } to { opacity: 1; transform: translateY(0); } }

/* Sheet Handle */
.sheet-handle {
  width: 40px; height: 5px; background: linear-gradient(90deg, #cbd9d0, #e3eee7);
  border-radius: 999px; margin: 8px auto 16px; transition: all 0.3s;
}
.sheet.dragging .sheet-handle { transform: scaleX(1.8); background: linear-gradient(90deg, #9bb7a6, #bcd7c6); }

/* Title */
.sheet h3 {
  font-size: 1.25rem; text-align: center; font-weight: 800; color: #2f4b3c; margin-bottom: 12px;
  background: linear-gradient(90deg, #4e6b58, #8fb79c); -webkit-background-clip: text; -webkit-text-fill-color: transparent;
}

/* Items */
.line-item { display: flex; justify-content: space-between; padding: 8px 0; border-bottom: 1px solid rgba(0,0,0,0.05); position: relative; overflow: hidden; transition: background 0.25s; }
.line-item:hover { background: rgba(245, 250, 246, 0.7); border-radius: 8px; }
.line-item .li-title { flex: 1; font-size: 15.5px; font-weight: 600; color: #2a2a2a; }
.line-item .li-sub { font-size: 15.5px; font-weight: 700; color: #305c46; }

/* Total Lines */
.sheet .line { display: flex; justify-content: space-between; margin: 6px 0; font-size: 15px; color: #333; }
.sheet .line.total { font-weight: 800; font-size: 16.5px; border-top: 1px solid rgba(0,0,0,0.05); padding-top: 10px; margin-top: 8px; color: #2f4b3c; }

/* Close Button */
#closeCartModal {
  width: 100%; margin-top: 18px; padding: 12px 0; border-radius: 12px;
  background: linear-gradient(135deg, #e9f1ec, #f8fbf9); border: 1px solid rgba(150, 170, 160, 0.35);
  font-size: 15px; color: #2f4b3c; font-weight: 600; transition: all 0.25s;
}
#closeCartModal:hover { background: linear-gradient(135deg, #d7e6dc, #eef6f0); transform: translateY(-1px); }


/* === 3. Success Modal (ÊàêÂäüÁï´Èù¢) === */
.success-backdrop {
  position: fixed; inset: 0; display: flex; align-items: center; justify-content: center;
  background: rgba(20, 32, 25, 0.25); backdrop-filter: blur(12px) saturate(160%);
  opacity: 0; visibility: hidden; transition: all 0.45s; z-index: 10050;
}
.success-backdrop.show { opacity: 1; visibility: visible; }

.success-card.glass-success {
  width: 86%; max-width: 420px; padding: 32px 28px 38px; border-radius: 24px;
  background: rgba(255, 255, 255, 0.55); border: 1px solid rgba(220, 235, 225, 0.6);
  backdrop-filter: blur(22px) saturate(180%); box-shadow: 0 20px 48px rgba(70, 90, 80, 0.22);
  animation: glassPop .45s cubic-bezier(.18,.89,.32,1.28);
}

/* ÊàêÂäüÂãæÂãæ */
.success-check { width: 94px; height: 94px; margin: 0 auto 16px; }
.check-circle { stroke: #7fa38a; stroke-width: 3.5; stroke-dasharray: 320; stroke-dashoffset: 320; animation: drawCircle 0.7s forwards; }
.check-mark { stroke: #4f705c; stroke-width: 4; stroke-dasharray: 80; stroke-dashoffset: 80; animation: drawCheck 0.4s 0.55s forwards; }
@keyframes drawCircle { to { stroke-dashoffset: 0; } }
@keyframes drawCheck { to { stroke-dashoffset: 0; } }

.success-title {
  font-size: 23px; font-weight: 800; margin-bottom: 6px;
  background: linear-gradient(90deg, #4e6b58, #8fb79c); -webkit-background-clip: text; -webkit-text-fill-color: transparent;
}
.success-sub { font-size: 15px; color: #3a5846; opacity: 0.85; margin-bottom: 22px; }

.success-info {
  background: rgba(255,255,255,0.65); border-radius: 18px; padding: 14px 18px; margin-bottom: 20px;
  border: 1px solid rgba(150,180,165,0.35); font-size: 15px; line-height: 1.75;
  box-shadow: 0 6px 18px rgba(70, 90, 80, 0.1);
}
.success-close {
  width: 100%; height: 48px; border-radius: 16px; font-size: 17px; font-weight: 750; color: #fff; border: none;
  background: linear-gradient(135deg, #5a7b68, #8fb79c); box-shadow: 0 10px 28px rgba(90,123,104,0.25); transition: all 0.25s;
}
.success-close:hover { transform: translateY(-2px); background: linear-gradient(135deg, #6d927c, #9fc7ab); }


/* === 4. Global Loading Overlay === */
.loading-overlay {
  position: fixed; inset: 0; background: rgba(255, 255, 255, 0.8); backdrop-filter: blur(4px);
  display: flex; flex-direction: column; justify-content: center; align-items: center;
  z-index: 9999; opacity: 0; pointer-events: none; transition: opacity 0.3s;
}
.loading-overlay.show { opacity: 1; pointer-events: auto; }
.loading-spinner { width: 48px; height: 48px; border: 4px solid #ccc; border-top-color: #1e90ff; border-radius: 50%; animation: spin 1s linear infinite; }
.loading-text { margin-top: 16px; font-size: 15px; font-weight: 600; color: #333; }
@keyframes spin { to { transform: rotate(360deg); } }