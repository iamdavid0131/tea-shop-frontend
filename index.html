<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <title>ç¥¥èˆˆå°ç£èŒ¶ç³»åˆ—è¨‚è³¼è¡¨å–®</title>
  <meta name="color-scheme" content="light" />
  <meta name="theme-color" content="#ffffff" />
  <!-- å»ºè­°ç”¨åŸºæº–ç‰ˆï¼Œç¸®æ”¾é–å®šäº¤çµ¦ app.js å‹•æ…‹è™•ç† -->
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
  <meta name="format-detection" content="telephone=no">
  <meta name="gas-exec" content="https://script.google.com/macros/s/AKfycbwc09A_Sj_kxrZZYn1y0QXgNbTVuQ0159ok6zUrg6u9xOEenrBFUXVwoxVJB_Zs6qANlA/exec">

  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-4QY9T0ZJS3"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-4QY9T0ZJS3', {
      send_page_view: true,
      debug_mode: location.search.includes('ga_debug=1')
    });
  </script>

  <!-- Leafletï¼ˆOSMï¼Œå…é‡‘é‘°ï¼‰â€” å»ºè­°ä¸è¦ deferï¼Œç¢ºä¿å…ˆæ–¼ app.js è¼‰å…¥ -->
  <link
    rel="stylesheet"
    href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
    integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
    crossorigin=""
  />
  <script
    src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
    integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
    crossorigin=""
  ></script>

  <!-- å¤–éƒ¨æ¨£å¼ -->
  <link rel="stylesheet" href="/assets/css/variables.css">

  <link rel="stylesheet" href="/assets/css/style.css">

  <link rel="stylesheet" href="/assets/css/cart.css">

  <link rel="stylesheet" href="/assets/css/store.css">

  <link rel="stylesheet" href="/assets/css/ai-chat.css">

  <!-- ç´”éœæ…‹ç‰ˆæœ¬ï¼šè®€å– URL promo ä¸¦å»£æ’­äº‹ä»¶ -->
  <script>
  document.addEventListener('DOMContentLoaded', () => {
    const qs = new URLSearchParams(location.search || '');
    const promo = String(qs.get('promoCode') || qs.get('promo') || '').trim().toUpperCase();
    if (!promo) return;
    const input = document.querySelector('#promoCode');
    if (input) {
      input.value = promo;
      input.dispatchEvent(new Event('input', { bubbles: true }));
    }
    window.dispatchEvent(new CustomEvent('promo:applied', { detail: { promo } }));
  });
  </script>

     <!-- ä¸» JSï¼ˆæŒ‡å‘ /api/*ï¼‰ -->
  <script type="module" src="assets/js/app.js"></script>
  <!-- GSAP -->
  <script src="https://cdn.jsdelivr.net/npm/gsap@3/dist/gsap.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/gsap@3/dist/ScrollTrigger.min.js"></script>

  <!-- Embla Carousel -->
  <script src="https://cdn.jsdelivr.net/npm/embla-carousel@8.0.0/embla.carousel.umd.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/embla-carousel-autoplay@8.0.0/embla.carousel.autoplay.umd.js"></script>

  <!-- iOS Modalï¼ˆå¯é¸ï¼Œå·²æ•´åˆï¼‰ -->
  <script src="https://cdn.jsdelivr.net/npm/body-scroll-lock/lib/bodyScrollLock.min.js"></script>
  <script type="module" src="assets/js/ai-shop.js"></script> 
  <script src="https://unpkg.com/phosphor-icons"></script>

</head>

<body>
<div class="aurora-bg">
  <div class="aurora-layer layer-1"></div>
  <div class="aurora-layer layer-2"></div>
  <div class="aurora-layer layer-3"></div>
</div>
<!-- âœ… iOS-style Large Title Header -->
<header class="ios-header">
  <div class="ios-nav">
    <div class="ios-status"></div>
    <h1 class="ios-title-lg">ç¥¥èˆˆå°ç£èŒ¶ç³»åˆ—è¨‚è³¼è¡¨å–®</h1>
    <div class="ios-subtitle">
      è¶…å•†æœªæ»¿ 1000 é‹è²» 60ï¼›è²¨åˆ°ä»˜æ¬¾æœªæ»¿ 2000 é‹è²» 100ï¼›é”æ¨™å…é‹
    </div>
  </div>
</header>
<div id="aiEntry"></div>

<!-- âœ… Step 1: å•†å“æ­¥é©Ÿ -->

<main id="teaScenes" class="tea-scenes"></main>

<div id="teaModal" class="tea-modal" aria-hidden="true">
  <div class="tea-modal-bg"></div>

  <div id="teaSheet" class="tea-modal-content">
    
    <header class="tea-modal-header">
      <h2 id="modalTitle"></h2>
      <button id="closeModalBtn" class="close-btn">âœ•</button>
    </header>

    <div id="teaCollection" class="tea-collection"></div>
  </div>
</div>





<!-- âœ… Step 2: æ”¶ä»¶è³‡æ–™ -->
<div class="section">
  <h2 class="section-title">æ”¶ä»¶è³‡æ–™</h2>

  <div class="form-group">
    <label for="phone">è¯çµ¡é›»è©±</label>
    <div id="err-phone" class="error-msg">è«‹è¼¸å…¥æœ‰æ•ˆé›»è©±</div>
    <input id="phone" class="sp-input" type="tel" placeholder="09xxxxxxxx æˆ– 0x-xxxxxxx">
    <span class="muted">è¼¸å…¥å¾Œå°‡è‡ªå‹•æŸ¥æ‰¾æœƒå“¡è³‡æ–™</span>
  </div>

  <div class="form-group">
    <label for="name">æ”¶ä»¶å§“å</label>
    <div id="err-name" class="error-msg">è«‹è¼¸å…¥å§“å</div>
    <input id="name" class="sp-input" type="text" placeholder="ç‹å°æ˜">
  </div>

  <div class="form-group">
    <label for="promo">å„ªæƒ ç¢¼</label>
    <div class="promo-row">
      <input id="promoCode" class="sp-input" type="text" placeholder="è«‹è¼¸å…¥å„ªæƒ ç¢¼">
      <button id="applyPromo">å¥—ç”¨</button>
    </div>
  </div>

  <div class="form-group">
    <label for="note">å‚™è¨»ï¼ˆé¸å¡«ï¼‰</label>
    <textarea id="note" class="sp-input" placeholder="ä¾‹å¦‚ï¼šæœ‰ä»»ä½•éœ€æ±‚è«‹è¨»æ˜ï¼ˆç¦®ç›’éœ€æ±‚ã€å»¶å¾Œå‡ºè²¨ç­‰ï¼‰"></textarea>
  </div>
</div>

<!-- âœ… Step 3: é‹é€æ–¹å¼ -->
<div class="section" id="shippingCard">
  <h2 class="section-title">é‹é€æ–¹å¼</h2>

  <div id="recentBox" class="recent-box hidden">
    <div class="recent-title">å¸¸ç”¨æ”¶ä»¶åœ°å€</div>
    <div class="recent-tabs">
      <button class="recent-tab active" data-type="store">ğŸª è¶…å•†</button>
      <button class="recent-tab" data-type="address">ğŸ“¦ å®…é…</button>
    </div>
    <div class="recent-list"></div>
  </div>

  <div class="ship-options">
    <label class="ship-radio">
      <input type="radio" name="shipping" value="store" checked>
      <span>è¶…å•†åº—åˆ°åº—</span>
    </label>

    <label class="ship-radio">
      <input type="radio" name="shipping" value="cod">
      <span>å®…é…</span>
    </label>
  </div>

  <!-- ===================== -->
  <!--      è¶…å•†æ¬„ä½ (OK)     -->
  <!-- ===================== -->
  <div id="storeFields">
    <div class="store-form">

      <label class="sp-label" for="carrier">é¸æ“‡è¶…å•†</label>
      <div class="store-row">
        <select id="carrier" class="sp-select">
          <option value="7-11">7-ELEVEN</option>
          <option value="familymart">å…¨å®¶ FamilyMart</option>
        </select>
        <button id="openStorePicker" class="sp-search-title">é™„è¿‘é–€å¸‚ â–¾</button>
      </div>

      <div class="store-row">
        <label for="storeName" class="sp-label">é–€å¸‚åº—å</label>
        <input id="storeName" type="text" class="sp-input" placeholder="è¼¸å…¥é™„è¿‘é–€å¸‚åç¨±æˆ–åœ°æ¨™â€¦" />
        <div id="err-store" class="error-msg">è«‹é¸æ“‡é–€å¸‚æˆ–è¼¸å…¥åº—å</div>
      </div>

    </div>
  </div>

  <!-- ===================== -->
  <!--      å®…é…æ¬„ä½ (OK)     -->
  <!-- ===================== -->
  <div id="codFields" class="delivery-form" style="display:none;">
    <div class="delivery-row">
      <div class="delivery-col">
        <label class="sp-label">ç¸£å¸‚</label>
        <select id="city" class="sp-select">
          <option value="">è«‹é¸æ“‡ç¸£å¸‚</option>
        </select>
      </div>

      <div class="delivery-col">
        <label class="sp-label">è¡Œæ”¿å€</label>
        <select id="district" class="sp-select">
          <option value="">è«‹é¸æ“‡è¡Œæ”¿å€</option>
        </select>
      </div>
    </div>

    <div class="delivery-full">
      <label class="sp-label">è©³ç´°åœ°å€</label>
      <input id="address" type="text" class="sp-input" placeholder="è«‹å¡«å…¥è·¯æ®µã€å··å¼„ã€é–€ç‰Œâ€¦" />
      <div id="err-address" class="error-msg">è«‹å¡«å¯«å®Œæ•´å®…é…åœ°å€</div>
    </div>
  </div>

</div>




<!-- âœ… Step 4: ä»˜æ¬¾æ–¹å¼ -->
<div class="section" id="paymentCard">
  <h2 class="section-title">ä»˜æ¬¾æ–¹å¼</h2>

  <div class="pay-options">
    <button type="button" class="pay-btn active" data-method="cod">
      <span class="pay-title">è²¨åˆ°ä»˜æ¬¾</span>
      <span class="pay-sub">åº—åˆ°åº— / å®…é…ä»˜æ¬¾</span>
    </button>

    <button type="button" class="pay-btn" data-method="online">
      <span class="pay-title">ç·šä¸Šæ”¯ä»˜</span>
      <span class="pay-sub">ä¿¡ç”¨å¡ / ATM / Apple Pay</span>
    </button>
  </div>
</div>


<!-- âœ… åŒé ï¼šéš±ç§åŒæ„ -->
<div class="consent-row">
  <label class="sp-toggle">
    <input type="checkbox" id="consentAgree" />
    <span class="sp-toggle-slider"></span>
    <div class="sp-toggle-text">
      <span class="sp-toggle-label">æˆ‘åŒæ„æä¾›è¯çµ¡è³‡è¨Šç”¨æ–¼å‡ºè²¨é€šçŸ¥èˆ‡å”®å¾Œæœå‹™</span>
      <span class="sp-consent-note">æˆ‘å€‘åƒ…æœƒä½¿ç”¨æ‚¨çš„è³‡æ–™æ–¼å‡ºè²¨é€šçŸ¥ã€å”®å¾Œæœå‹™ï¼Œä¸å¦ä½œè¡ŒéŠ·ç”¨é€”ã€‚</span>
    </div>
  </label>
</div>

<!-- âœ… é€å‡ºè¨‚å–®æŒ‰éˆ• -->
<div class="submit-area">
  <button id="submitOrderBtn" class="submit-btn" disabled>é€å‡ºè¨‚å–®
  </button>
</div>



 <div id="store-picker" aria-hidden="true">
  <div class="sp-backdrop"></div>
  <div class="sp-sheet">
    <div class="sp-handle"></div>
    
    <div class="sp-header">
      <h3>é¸æ“‡å–è²¨é–€å¸‚</h3>
      <button class="sp-close" data-sp-close>Ã—</button>
    </div>

    <select id="sp-brand" class="sp-select" style="margin-bottom:10px;">
      <option value="all">å…¨éƒ¨å“ç‰Œ</option>
      <option value="7-11">7-ELEVEN</option>
      <option value="familymart">å…¨å®¶</option>
    </select>
    
    <input id="sp-q" type="text" class="sp-input" placeholder="è¼¸å…¥åœ°æ¨™æˆ–åœ°å€" style="margin-bottom:10px;">
    
    <button id="sp-search-btn" class="sp-search-title" style="width:100px;">æœå°‹</button>

    <div id="sp-map"></div> 

    <div id="sp-results" class="sp-results"></div>
  </div>
</div>

 

 <div class="stickybar glassy" id="StickyBar">
  
  <div id="freeProgress" class="progress-bar-wrap hidden">
    <div id="freeProgressBar"></div>
  </div>
  <div class="free-hint" id="freeHint">ğŸŒ¿ å·²é”å…é‹é–€æª»ï¼å†æ·»ä¸€å£ºèŒ¶æ›´é¦™æ°£æ»¿æº¢ï½</div>
  <span id="free_tip_s" class="muted" style="display:none"></span> <div class="sticky-inner">
    
    <div class="amount-box">
      <div class="grand-total">
        <span class="label">ç¸½è¨ˆ</span>
        <b id="total_s" class="money-pop">NT$ 0</b>
      </div>
      <div class="sub-detail">
        <span id="sub_s">å°è¨ˆ â€”</span>
        <span id="ship_s" class="ship-tag">é‹è²» â€”</span>
      </div>
    </div>

    <div class="action-box">
      <button id="viewCartBtn" class="icon-btn" type="button" aria-label="æŸ¥çœ‹æ˜ç´°">
        <span class="arrow-icon">â–²</span>
      </button>
      
      <button id="submitBtnSticky" class="submit-btn-sticky" type="button" onclick="document.getElementById('submit-area').scrollIntoView({behavior: 'smooth'})">
        å»è²·å–®
      </button>
    </div>

  </div>
</div>

<div id="cartSheetBackdrop" class="sheet-backdrop" aria-hidden="true">
  <div id="cartSheet" class="sheet" data-open="false">
    
    <div class="sheet-handle"></div>
    
    <h3>è³¼ç‰©æ˜ç´°</h3>
    
    <div id="cartItems"></div>
    
    <div class="line">
      <span>å°è¨ˆ</span>
      <b id="cartSub">NT$ 0</b>
    </div>
    
    <div class="line" id="cartDiscRow" style="display: none;">
      <span>æŠ˜æ‰£</span>
      <b id="cartDisc" style="color: #e74c3c;"></b>
    </div>
    
    <div class="line">
      <span>é‹è²»</span>
      <b id="cartShip">NT$ 0</b>
    </div>
    
    <div class="line total">
      <span>æ‡‰ä»˜ç¸½é¡</span>
      <b id="cartTotal">NT$ 0</b>
    </div>
    
    <div id="promoMsg" class="muted" style="margin-top:12px; text-align:center; min-height:20px;"></div>
    
    <button id="closeCartModal" type="button">é—œé–‰</button>
    
  </div>
</div>
<!-- âœ… æˆåŠŸæç¤ºæ¨¡çµ„ -->
<div id="successBackdrop" class="success-backdrop hidden">
  <div class="success-card glass-success">

    <!-- ğŸ‰ å‹¾å‹¾å‹•ç•« -->
    <svg class="success-check" viewBox="0 0 100 100">
      <circle class="check-circle" cx="50" cy="50" r="40" fill="none"/>
      <path class="check-mark" fill="none" d="M30 52 L45 67 L70 40"/>
    </svg>

    <div class="success-title">è¨‚å–®æˆåŠŸ</div>
    <div class="success-sub">æ„Ÿè¬æ‚¨çš„æ”¯æŒï¼ŒèŒ¶é¦™å³å°‡ç‚ºæ‚¨é€ä¸Š ğŸƒ</div>

    <div class="success-info">
      <div><strong>è¨‚å–®ç·¨è™Ÿ</strong><span id="successOrderId">â€”</span></div>
      <div><strong>è¨‚å–®é‡‘é¡</strong><span id="successTotal">â€”</span></div>
    </div>

    <!-- LINE ç¶å®š -->
    <div id="lineBindBox">
      <a id="successLine" class="line-bind-btn">åŠ å…¥ LINE æ¥æ”¶å‡ºè²¨é€šçŸ¥</a>
    </div>

    <!-- è¿”å›æŒ‰éˆ• -->
    <button id="successClose" class="success-close">è¿”å›è¨‚è³¼é </button>
  </div>
</div>

<!-- âœ… å…¨è¢å¹• Loading å‹•ç•« -->
<div id="globalLoading" class="loading-overlay hidden" aria-hidden="true">
  <div class="loading-spinner"></div>
  <div class="loading-text">æ­£åœ¨é€å‡ºè¨‚å–®â€¦</div>
</div>


 
<script>
    // ç°¡å–®çš„ç¯„ä¾‹ï¼šè®“ Header è¼‰å…¥æ™‚æœ‰èŒ¶éœ§æ»‘å…¥æ•ˆæœ
    document.addEventListener("DOMContentLoaded", () => {
        const header = document.querySelector('.ios-header');
        // CSS å‹•ç•«æœƒè‡ªå‹•æ’­æ”¾ (teaHeaderEnter)
        
        // æ¸¬è©¦ï¼šé»æ“ŠèŒ¶å¡ç‰‡æœƒæœ‰åæ‡‰
        const cards = document.querySelectorAll('.tea-card');
        cards.forEach(card => {
            card.addEventListener('click', () => {
                // é€™è£¡å¯ä»¥åŠ å…¥æ‰“é–‹ Modal çš„é‚è¼¯
                console.log('èŒ¶å¡ç‰‡è¢«é»æ“Š');
            });
        });
    });

    // è®“ Aurora èƒŒæ™¯éš¨æ»‘é¼ è¼•å¾®ç§»å‹• (è¦–å·®æ•ˆæœ)
    document.addEventListener('mousemove', (e) => {
        const layers = document.querySelectorAll('.aurora-layer');
        const x = (window.innerWidth - e.pageX * 2) / 100;
        const y = (window.innerHeight - e.pageY * 2) / 100;

        layers.forEach((layer, index) => {
            const speed = (index + 1) * 2;
            layer.style.transform = `translateX(${x * speed}px) translateY(${y * speed}px)`;
        });
    });
</script>
</body>
<script src="https://cdn.jsdelivr.net/npm/hammerjs@2.0.8/hammer.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/body-scroll-lock/lib/bodyScrollLock.min.js"></script>


</html>
