<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <title>ç¥¥èˆˆå°ç£èŒ¶ç³»åˆ—è¨‚è³¼è¡¨å–®</title>
  <meta name="color-scheme" content="light" />
  <meta name="theme-color" content="#ffffff" />
  <!-- å»ºè­°ç”¨åŸºæº–ç‰ˆï¼Œç¸®æ”¾é–å®šäº¤çµ¦ app.js å‹•æ…‹è™•ç† -->
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
  <meta name="format-detection" content="telephone=no">
  <meta name="gas-exec" content="https://script.google.com/macros/s/AKfycbwc09A_Sj_kxrZZYn1y0QXgNbTVuQ0159ok6zUrg6u9xOEenrBFUXVwoxVJB_Zs6qANlA/exec">

  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-4QY9T0ZJS3"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-4QY9T0ZJS3', {
      send_page_view: true,
      debug_mode: location.search.includes('ga_debug=1')
    });
  </script>

  <!-- Leafletï¼ˆOSMï¼Œå…é‡‘é‘°ï¼‰â€” å»ºè­°ä¸è¦ deferï¼Œç¢ºä¿å…ˆæ–¼ app.js è¼‰å…¥ -->
  <link
    rel="stylesheet"
    href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
    integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
    crossorigin=""
  />
  <script
    src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
    integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
    crossorigin=""
  ></script>

  <!-- å¤–éƒ¨æ¨£å¼ -->
  <link rel="stylesheet" href="/assets/css/style.css">

  <!-- ç´”éœæ…‹ç‰ˆæœ¬ï¼šè®€å– URL promo ä¸¦å»£æ’­äº‹ä»¶ -->
  <script>
  document.addEventListener('DOMContentLoaded', () => {
    const qs = new URLSearchParams(location.search || '');
    const promo = String(qs.get('promoCode') || qs.get('promo') || '').trim().toUpperCase();
    if (!promo) return;
    const input = document.querySelector('#promoCode');
    if (input) {
      input.value = promo;
      input.dispatchEvent(new Event('input', { bubbles: true }));
    }
    window.dispatchEvent(new CustomEvent('promo:applied', { detail: { promo } }));
  });
  </script>
</head>

<body>
  <div id="loading" role="status" aria-live="polite">é€å‡ºä¸­â€¦è«‹ç¨å€™</div>
  <div class="rotate-hint" id="rotateHint">å»ºè­°ä»¥ç›´å¼ç€è¦½ï¼Œç²å¾—æ›´å¥½çš„é«”é©— ğŸ™Œ</div>

  <!-- iOS-style Large Title Header -->
  <header class="ios-header">
    <div class="ios-nav">
      <div class="ios-status"></div>
      <h1 class="ios-title-lg">ç¥¥èˆˆå°ç£èŒ¶ç³»åˆ—è¨‚è³¼è¡¨å–®</h1>
      <div class="ios-subtitle">è¶…å•†æœªæ»¿ 1000 é‹è²» 60ï¼›è²¨åˆ°ä»˜æ¬¾æœªæ»¿ 2000 é‹è²» 100ï¼›é”æ¨™å…é‹</div>
    </div>
  </header>

  <!-- å•†å“æ­¥é©Ÿ -->
  <div class="card stepcard" id="itemsCard">
    <h2>é¸è³¼å•†å“</h2>
    <div id="categoryList" class="itemlist"></div>
  </div>

  <div class="section">
  <h2 class="section-title">æ”¶ä»¶è³‡æ–™</h2>

  <div class="form-group">
    <label for="phone">è¯çµ¡é›»è©±</label>
    <input id="phone" type="tel" placeholder="09xxxxxxxx æˆ– 0x-xxxxxxx">
    <span class="muted">è¼¸å…¥å¾Œå°‡è‡ªå‹•æŸ¥æ‰¾æœƒå“¡è³‡æ–™</span>
  </div>

  <div class="form-group">
    <label for="name">æ”¶ä»¶å§“å</label>
    <input id="name" type="text" placeholder="ç‹å°æ˜">
  </div>

  <div class="form-group">
    <label for="promo">å„ªæƒ ç¢¼</label>
    <div class="promo-row">
      <input id="promoCode" type="text" placeholder="è«‹è¼¸å…¥å„ªæƒ ç¢¼">
      <button id="applyPromo">å¥—ç”¨</button>
    </div>
  </div>

  <div class="form-group">
    <label for="note">å‚™è¨»ï¼ˆé¸å¡«ï¼‰</label>
    <textarea id="note" placeholder="ä¾‹å¦‚ï¼šæœ‰ä»»ä½•éœ€æ±‚è«‹è¨»æ˜ï¼ˆç¦®ç›’éœ€æ±‚ã€å»¶å¾Œå‡ºè²¨ç­‰ï¼‰"></textarea>
  </div>
</div>

 <!-- æ”¶ä»¶å€å¡Š -->
 <div class="section" id="shippingCard">
  <h2 class="section-title">é‹é€æ–¹å¼</h2>

  <div class="ship-options">
    <label class="ship-radio">
      <input type="radio" name="ship" value="store" checked>
      <span>è¶…å•†åº—åˆ°åº—ï¼ˆå–è²¨ä»˜æ¬¾ï¼‰</span>
    </label>

    <label class="ship-radio">
      <input type="radio" name="ship" value="cod">
      <span>å®…é…ï¼ˆè²¨åˆ°ä»˜æ¬¾ï¼‰</span>
    </label>
  </div>

  <!-- âœ… è¶…å•†åº—åˆ°åº— -->
  <div id="storeFields">
    <label>é¸æ“‡è¶…å•†</label>
    <div class="store-row">
      <select id="carrier">
        <option value="7-11">7-ELEVEN</option>
        <option value="å…¨å®¶">å…¨å®¶ FamilyMart</option>
      </select>
      <button id="openStorePicker" class="btn btn-outline">é™„è¿‘é–€å¸‚ â–¾</button>
    </div>

    <label>é–€å¸‚åº—å</label>
    <input id="storeName" type="text" placeholder="è¼¸å…¥é™„è¿‘é–€å¸‚åç¨±æˆ–åœ°æ¨™â€¦">

    <div id="storeResults" class="store-results"></div>
  </div>

  <!-- âœ… å®…é…åˆ°åºœ -->
<div id="codFields" style="display:none;">
  <label>ç¸£å¸‚</label>
  <select id="city"></select>

  <label>è¡Œæ”¿å€</label>
  <select id="district"></select>

  <div class="zipcode-box">
    éƒµéå€è™Ÿï¼š<span id="zipDisplay">â€”</span>
    <input id="zipCode" type="hidden">
  </div>

  <label>è©³ç´°åœ°å€</label>
  <input id="address" type="text" placeholder="è«‹å¡«å…¥è·¯æ®µã€å··å¼„â€¦">
</div>


  <label class="consent-row">
    <input type="checkbox" id="consent">
    æˆ‘åŒæ„æä¾›è¯çµ¡è³‡è¨Šç”¨æ–¼å‡ºè²¨é€šçŸ¥èˆ‡å”®å¾Œæœå‹™
  </label>
</div>


  <!-- åŒé ï¼šè¶…å•†é–€å¸‚é¸æ“‡å™¨ Bottom Sheet -->
<div id="store-picker" aria-hidden="true">
  <div class="sp-backdrop" data-sp-close></div>
  <section class="sp-sheet" role="dialog" aria-modal="true">
    <div class="sp-handle"></div>

    <header class="sp-header">
      <h3 id="sp-title">é¸æ“‡å–è²¨é–€å¸‚</h3>
      <button class="sp-close" type="button" title="é—œé–‰" data-sp-close>âœ•</button>
    </header>

    <div class="sp-toolbar">
      <select id="sp-brand" class="sp-select sp-brand">
        <option value="all">å…¨éƒ¨å“ç‰Œ</option>
        <option value="7-11">7-ELEVEN</option>
        <option value="familymart">å…¨å®¶ FamilyMart</option>
      </select>
      <select id="sp-radius">
        <option value="500">500m</option>
        <option value="1000" selected>1000m</option>
        <option value="1500">1500m</option>
      </select>
      <button id="sp-nearby" type="button">é™„è¿‘é–€å¸‚</button>
    </div>

    <div class="sp-search">
      <input id="sp-q" class="sp-input sp-query" type="search" placeholder="è¼¸å…¥åœ°æ¨™æˆ–åœ°å€">
      <button id="sp-search-btn" class="sp-search-title" type="button">æœå°‹</button>
    </div>

    <div id="sp-map" class="sp-map" aria-label="åœ°åœ–"></div>
    <div class="sp-scroll">
      <div id="sp-results" class="sp-results"></div>
    </div>
  </section>
</div>


 

  <!-- Sticky checkout bar -->
<div class="stickybar glassy" id="StickyBar">
  <div class="sticky-inner">
    <div class="stack amounts">
      <div class="grand">
        æ‡‰ä»˜ç¸½é¡ï¼š<b id="total_s">NT$ 0</b>
      </div>

      <div id="stickySubDetail" class="">
        <div class="subline">
          å°è¨ˆ <span id="sub_s">â€”</span>
          <span id="disc_wrap"> ãƒ» æŠ˜æ‰£ <span id="disc_s">â€”</span></span>
          ãƒ» é‹è²» <span id="ship_s">â€”</span>
        </div>

        <div id="freeProgress" class="progress-bar-wrap hidden">
          <div id="freeProgressBar"></div>
        </div>
        <span id="free_tip_s" class="muted"></span>
      </div>
    </div>

    <button id="viewCartBtn" class="btn btn-outline" type="button">æŸ¥çœ‹æ˜ç´° â–¾</button>
    <button id="submitBtnSticky" class="btn" type="button" disabled>é€å‡ºè¨‚å–®</button>
  </div>
</div>


<!-- è³¼ç‰©æ˜ç´° Bottom Sheet -->
<div id="cartSheetBackdrop" class="sheet-backdrop" aria-hidden="true">
  <div id="cartSheet" class="sheet" data-open="false">
    <div class="sheet-handle"></div>
    <h3>è³¼ç‰©æ˜ç´°</h3>
    <div id="cartItems"></div>
    <div class="line"><span>å°è¨ˆ</span><b id="cartSub">â€”</b></div>
    <div class="line" id="cartDiscRow"><span>æŠ˜æ‰£</span><b id="cartDisc">â€”</b></div>
    <div class="line"><span>é‹è²»</span><b id="cartShip">â€”</b></div>
    <div class="line total"><span>æ‡‰ä»˜ç¸½é¡</span><b id="cartTotal">â€”</b></div>
    <div id="promoMsg" class="muted" style="margin-top:8px;"></div>
    <button id="closeCartModal" class="btn btn-outline">é—œé–‰</button>
  </div>
</div>


  <!-- æˆåŠŸå¡ç‰‡ -->
  <div id="successBackdrop" class="modal-backdrop" aria-hidden="true">
    <div class="modal-card" role="dialog" aria-modal="true" aria-labelledby="successTitle">
      <div class="success-icon">âœ“</div>
      <div id="successTitle" class="big">è¨‚å–®å·²é€å‡º</div>
      <div class="muted" id="successDetail">æ„Ÿè¬æ‚¨çš„è¨‚è³¼ã€‚</div>

      <div class="order-summary">
        <div><strong>è¨‚å–®ç·¨è™Ÿï¼š</strong><span id="successOrderId"></span></div>
        <div><strong>é‡‘é¡ï¼š</strong><span id="successTotal"></span> å…ƒ</div>
      </div>

      <div class="line-bind-box" id="lineBindBox" hidden>
        <div class="line-bind-title">LINE é€šçŸ¥ç¶å®š</div>
        <div class="line-bind-text">é»æ“Šä¸‹æ–¹æŒ‰éˆ•å³å¯è¿½è¹¤è¨‚å–®é€²åº¦èˆ‡å‡ºè²¨ç‹€æ…‹ã€‚</div>
        <a id="lineBindBtn" class="line-bind-btn" target="_blank">ğŸ”— å‰å¾€ LINE ç¶å®š</a>
        <div class="line-bind-note">è‹¥å°šæœªåŠ å¥½å‹ï¼Œç³»çµ±æœƒå…ˆè·³å‡ºåŠ å¥½å‹ç•«é¢ã€‚</div>
      </div>

      <div class="ok">
        <button id="successClose" class="btn" type="button">å›åˆ°è¡¨å–®</button>
      </div>
    </div>
  </div>

  <!-- é€å‡ºå‰ç¢ºèªï¼šBottom Sheet -->
  <div id="sheetBackdrop" class="sheet-backdrop" aria-hidden="true">
    <div class="sheet" role="dialog" aria-modal="true" aria-labelledby="confirmTitle">
      <h3 id="confirmTitle">ç¢ºèªè¨‚å–®å…§å®¹</h3>
      <div id="sheetItems"></div>
      <hr style="border:none;border-top:1px solid #eee;margin:8px 0;">
      <div class="line"><span>å°è¨ˆ</span><b id="sheetSub">â€”</b></div>
      <div class="line"><span>æŠ˜æ‰£</span><b id="sheetDisc">â€”</b></div>
      <div class="line"><span>é‹è²»</span><b id="sheetShip">â€”</b></div>
      <div class="line total"><span>æ‡‰ä»˜ç¸½é¡</span><b id="sheetTotal">â€”</b></div>
      <div class="actions">
        <button id="sheetCancel" class="btn btn-outline" type="button">è¿”å›ä¿®æ”¹</button>
        <button id="sheetConfirm" class="btn" type="button">ç¢ºèªé€å‡º</button>
      </div>
    </div>
  </div>
  <div id="undoToast" style="position:fixed;left:50%;bottom:calc(20px + env(safe-area-inset-bottom));transform:translateX(-50%);background:#111;color:#fff;padding:10px 14px;border-radius:12px;box-shadow:0 8px 20px rgba(0,0,0,.25);font-size:14px;display:none;z-index:1003;">
    <span id="undoMsg"></span>
    <button id="undoBtn" type="button" style="margin-left:10px;background:#fff;color:#111;border:0;border-radius:8px;padding:4px 10px;font-weight:700;">å¾©åŸ</button>
  </div>

    <!-- ä¸» JSï¼ˆæŒ‡å‘ /api/*ï¼‰ -->
  <script type="module" src="assets/js/app.js"></script>
</body>
</html>
